library(TwoSampleMR)
library(MRInstruments)
library(ieugwasr)
library(devtools)
Sys.setenv(OPENGWAS_JWT = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaS1qd3QiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhcGkub3Blbmd3YXMuaW8iLCJhdWQiOiJhcGkub3Blbmd3YXMuaW8iLCJzdWIiOiJ2aWxoYXIuc0BnbWFpbC5jb20iLCJpYXQiOjE3MTc0Mjg4MDIsImV4cCI6MTcxODYzODQwMn0.pVFcGa8QLK6u_KVaQpZpgcWnzUel1jGGPaIdQRTYQQQLMFOeCKXoQG6JvmlUQv-dbv336faik2yM2bFqs8sDYn7i_wLmWOmKrePWZmCtfyMlQrSg-lOGhQg60-3XpEyLc2S42_ylqJipKmESSqLFnyExVwjieno1vtKj-NzytgOG2vxMAVJN_8hpMNa6TlySjtnN8sdrHXBat2uO_5AxP_IxG8fkydfEteRQToCnNWM2Or3bapIyZBA9F2o6UDsoKYamqssWy5OQOcbvXD3gq2QGMsUdzfivQYqM90MXTql7da9lEYKPtb2BoLKY7Xnz2o21syvAlRIsG2tcutg8hQ")
exposure_gwas <- gwas_catalog
View(exposure_gwas)
exposure_gwas_bc_aa <- subset(gwas_catalog, grepl("African", Initial_sample_description) & Phenotype_simple == "Breast cancer")
View(exposure_gwas_bc_aa)
exposure_data <- format_data(exposure_gwas_bc_aa)
exposure_data <- clump_data(exposure_data, clump_r2 = 0.001)
exposure_data <- format_data(exposure_gwas_bc_aa)
exposure_data <- clump_data(exposure_data, clump_r2 = 0.001, pop = "AFR")
ao <- available_outcomes()
outcome_data <- extract_instruments(outcomes = 'ebi-a-GCST90101746')
View(outcome_data)
# 1st analysis with HDL
# clumped using AFR population
View(outcome_data)
View(exposure_data)
View(outcome_data)
View(exposure_data)
View(outcome_data)
outcome_data <- extract_outcome_data(snps = exposure_data$SNP, outcomes = "ebi-a-GCST90101746")
# This is the used outcome_data table with SNPs matched to exposure_data
outcome_data_LDL <- extract_outcome_data(snps = exposure_data$SNP, outcomes = "ebi-a-GCST90101745")
h_data_HDL <- harmonise_data(exposure_dat = exposure_data, outcome_dat = outcome_data)
h_data_LDL <- harmonise_data(exposure_dat = exposure_data, outcome_dat = outcome_data_LDL)
# Separate harmonised data for HDL and LDL both with the same BC SNPs to be used for 2 separate MRs
mr_results <- mr(h_data_HDL)
mr_results <- mr(h_data_LDL)
mr_results <- mr(h_data_HDL)
mr_results_LDL <- mr(h_data_LDL)
mr_results_HDL <- mr(h_data_HDL)
View(mr_results)
View(mr_results_HDL)
View(mr_results_LDL)
# None significant
mr_method_list()
mr_pleiotropy_test(h_data)
mr_pleiotropy_test(h_data_HDL)
pleiotropy_HDL <- mr_pleiotropy_test(h_data_HDL)
pleiotropy_LDL <- mr_pleiotropy_test(h_data_LDL)
View(pleiotropy_LDL)
heterogeneity_HDL <- mr_heterogeneity(h_data_HDL, method_list = c("mr_egger_regression", "mr_ivw"))
View(heterogeneity_HDL)
heterogeneity_LDL <- mr_heterogeneity(h_data_LDL, method_list = c("mr_egger_regression", "mr_ivw"))
View(heterogeneity_LDL)
scatter_plot_HDL <- mr_scatter_plot(mr_results_HDL, h_data_HDL)
View(scatter_plot_HDL)
scatter_plot_HDL
scatter_plot_LDL <- mr_scatter_plot(mr_results_LDL, h_data_LDL)
scatter_plot_LDL
res_single_HDL <- mr_singlesnp(h_data_HDL)
res_single_LDL <- mr_singlesnp(h_data_LDL)
forrest_plot_HDL <- mr_forest_plot(res_single_HDL)
forrest_plot_LDL <- mr_forest_plot(res_single_LDL)
forrest_plot_HDL
forrest_plot_LDL
funnel_plot_HDL <- mr_funnel_plot(res_single_HDL)
funnel_plot_LDL <- mr_funnel_plot(res_single_LDL)
funnel_plot_HDL
funnel_plot_LDL <- mr_funnel_plot(res_single_LDL
funnel_plot_HDL
funnel_plot_LDL <- mr_funnel_plot(res_single_LDL)
funnel_plot_LDL
library(writexl)
write_xlsx(exposure_data, path = "exposure_data.xlsx")
write_xlsx(outcome_data, path = "outcome_data_HDL.xlsx")
write_xlsx(outcome_data_LDL, path = "outcome_data_LDL.xlsx")
write_xlsx(h_data_HDL, path = "harmonised_data_for_analyses_HDL.xlsx")
write_xlsx(h_data_LDL, path = "harmonised_data_for_analyses_LDL.xlsx")
write_xlsx(mr_results_HDL, path = "mr_results_HDL.xlsx")
write_xlsx(mr_results_LDL, path = "mr_results_LDL.xlsx")
write_xlsx(heterogeneity_HDL, path = "heterogeneity_results_HDL.xlsx")
write_xlsx(heterogeneity_LDL, path = "heterogeneity_results_LDL.xlsx")
write_xlsx(pleiotropy_HDL, path = "pleiotropy_results_HDL.xlsx")
write_xlsx(pleiotropy_LDL, path = "pleiotropy_results_LDL.xlsx")
savehistory("~/Desktop/Mendelian Randomisation/BC_HDLxLDL/BC_HDLxLDL/Code_MR_BCxHDL&LDL.Rhistory")
